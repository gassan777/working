define("bundles/content-feedback/actions/CourseRatingActions",["require","exports","module","bundles/content-feedback/models/CourseRatingStats","bundles/content-feedback/models/RatingFeedback","bundles/content-feedback/utils/CourseRatingAPIUtils"],function(require,exports,module){"use strict";var t=require("bundles/content-feedback/models/CourseRatingStats"),n=require("bundles/content-feedback/models/RatingFeedback"),e=require("bundles/content-feedback/utils/CourseRatingAPIUtils");exports.changeBranchId=function(t,e){var a=e.courseId,n=e.branchId,i=e.ratingValue,r=e.learnerAudience,c=e.reviewCollection;t.dispatch("SET_FEEDBACK_BRANCH_ID",{branchId:n}),t.executeAction(exports.getCourseReviews,{courseId:a,branchId:n,reviewCollection:c,ratingValue:i,learnerAudience:r}),t.executeAction(exports.getCourseRatingStats,{courseId:a,branchId:n,learnerAudience:r})},exports.getCourseReviews=function(a,t){var r=t.courseId,i=t.branchId,n=t.reviewCollection,c=t.ratingValue,o=t.learnerAudience;return a.dispatch("GET_REVIEWS",{reviewCollection:n}),e.getReviews(r,i,o,n.page,c.value).then(function(e){var t=e.feedbacks,r=e.totalCount;a.dispatch("RECEIVE_REVIEWS",{reviewCollection:n,feedbacks:t,totalCount:r})}).done()},exports.filterCourseReviews=function(t,e){var r=e.courseId,i=e.branchId,n=e.ratingValue,c=e.learnerAudience,o=t.getStore("CourseRatingStore");t.dispatch("FILTER_REVIEWS",{ratingValue:n});var a=o.getReviewCollection();a.isEmpty()&&t.executeAction(exports.getCourseReviews,{courseId:r,branchId:i,reviewCollection:a,ratingValue:n,learnerAudience:c})},exports.getCourseRatingStats=function(i,n){var c=n.courseId,o=n.branchId,u=n.learnerAudience,a=n.totalCount,r=n.averageRating;return e.getRatingStats(c,o,u).then(function(n){var e={};void 0!==a&&void 0!==r&&(e={totalCount:a,averageRating:r});var c=new t(n,e);i.dispatch("RECEIVE_COURSE_RATING_STATS",{courseRatingStats:c})}).done()},exports.filterCourseRatings=function(e,t){var a=t.courseId,r=t.branchId,o=t.ratingValue,n=t.learnerAudience,i=e.getStore("CourseRatingStore");e.dispatch("FILTER_RATINGS",{learnerAudience:n});var c=i.getReviewCollection(),u=i.getCourseRatingStats();c.isEmpty()&&e.executeAction(exports.getCourseReviews,{courseId:a,branchId:r,reviewCollection:c,ratingValue:o,learnerAudience:n}),u||e.executeAction(exports.getCourseRatingStats,{courseId:a,branchId:r,learnerAudience:n})},exports.receiveMyCourseRating=function(e,t){var n=t.ratingFeedback;e.dispatch("RECEIVE_MY_RATING",{ratingFeedback:n})},exports.postMyCourseRating=function(r,t){var i=t.courseId,c=t.value,o=t.active,u=t.comment,a=new n(c,o,u);return r.executeAction(exports.receiveMyCourseRating,{ratingFeedback:a}),e.postFeedback(i,a)},exports.deleteFeedback=function(n,t){return e.deleteFeedback(t).then(function(){n.dispatch("DELETE_FEEDBACK",t)}).done()}});