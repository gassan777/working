define("bundles/content-feedback/models/CourseRatings",["require","exports","module","underscore","bundles/content-feedback/constants/RatingValues","bundles/content-feedback/constants/LearnerAudiences","bundles/content-feedback/models/RatingCollection","bundles/author-branches/constants"],function(require,exports,module){"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function defineProperties(i,n){for(var t=0;t<n.length;t++){var e=n[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(i,e.key,e)}}return function(e,t,n){return t&&defineProperties(e.prototype,t),n&&defineProperties(e,n),e}}(),_=require("underscore"),e=require("bundles/content-feedback/constants/RatingValues"),t=require("bundles/content-feedback/constants/LearnerAudiences"),a=require("bundles/content-feedback/models/RatingCollection"),s=require("bundles/author-branches/constants"),n=s.ALL_BRANCHES,o=function(){function CourseRatings(){_classCallCheck(this,CourseRatings),this.ratingValue=_(e).find(function(e){return-1===e.value}),this.learnerAudience=_(t).find(function(e){return"ALL_LEARNERS"===e.id}),this.branchId=n,this.statsMap={},this.reviewCollectionsMap={},this.initMapsForBranchId(n)}return CourseRatings.prototype.initMapsForBranchId=function initMapsForBranchId(n){var i=this;this.statsMap[n]={},this.reviewCollectionsMap[n]={},_(t).each(function(o){var t=o.id,s={};_(e).each(function(e){s[e.value]=new a}),i.statsMap[n][t]=null,i.reviewCollectionsMap[n][t]=s})},CourseRatings.prototype.setBranchId=function setBranchId(e){this.branchId=e,this.statsMap[e]||this.initMapsForBranchId(e)},CourseRatings.prototype.setRatingValue=function setRatingValue(e){this.ratingValue=e},CourseRatings.prototype.setLearnerAudience=function setLearnerAudience(e){this.learnerAudience=e},CourseRatings.prototype.appendReviews=function appendReviews(t,n){var e=this.reviewCollection;e.appendPage(t),e.setTotalCount(n)},CourseRatings.prototype.deleteReview=function deleteReview(e){_(this.reviewCollectionsMap).each(function(t){return _(t).each(function(t){t.models=_(t.models).filter(function(t){return t.id!==e})})})},CourseRatings.prototype.setStats=function setStats(e){this.statsMap[this.branchId][this.learnerAudience.id]=e},i(CourseRatings,[{key:"reviewCollection",get:function get(){return this.reviewCollectionsMap[this.branchId][this.learnerAudience.id][this.ratingValue.value]}},{key:"stats",get:function get(){return this.statsMap[this.branchId][this.learnerAudience.id]}}]),CourseRatings}();module.exports=o});